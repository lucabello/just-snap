name: Pull Request

on:
  pull_request:


jobs:
  test:
    name: Test snap
    runs-on: ubuntu-latest
    steps:
      - name: Checkout repository
        uses: actions/checkout@v4
        with:
          fetch-depth: 1
      - name: Install dependencies
        env:
          CONCIERGE_LXD_CHANNEL: 6/stable
        run: |
          sudo snap install concierge --classic
          sudo concierge prepare -p crafts
          sudo snap install lxd --channel="$LXD_CHANNEL"
          lxd init --auto
      - name: Run the tests
        run: |
          snapcraft test --platform=amd64
