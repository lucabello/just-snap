summary: Check the version output

environment:
  SNAP_VERSION: "$(sed -n 's/^version: //p' ${PROJECT_PATH}/snap/snapcraft.yaml)"

execute: |
  printenv
  echo "+ Shell is $SHELL"
  just --version  # Make sure the command works
  just_version="$(just --version)"
  if [[ "just ${SNAP_VERSION}" != "$just_version" ]]; then
    echo "The snap version differs from the Just version!"
    echo "snapcraft.yaml (just ${SNAP_VERSION}) != built version ($just_version)"
    exit 1
  fi
